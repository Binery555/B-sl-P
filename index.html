<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <title>Untitled</title>
  

</head>
<body>
<!-- partial:index.partial.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Binance Futures Positions</title>
  <!-- Binance Plex Webfont -->
  <link
    href="https://db.onlinewebfonts.com/c/d05c19ccecf7003d248c60ffd6b5e8f7?family=Binance+PLEX"
    rel="stylesheet"
  />
  <!-- Font Awesome -->
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
  />
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    :root {
      --panel-bg: #1e2127;
      --secondary-bg: #32383e;
      --btn-bg: #2f3339;
      --text-primary: #ffffff;
      --text-secondary: #7c828a;
      --text-green: #3acf87;
      --text-red: #e04b4a;
      --highlight: #f0b90b;
    }
    body {
      margin: 0;
      padding: 0;
      background-color: var(--panel-bg);
      color: #b0b0b0;
      font-family: 'Binance PLEX', sans-serif;
      display: flex;
      flex-direction: column;
      height: 100vh;
      max-width: 430px;
      margin: 0 auto;
    }

    .header-wrapper { display: flex; justify-content: center; margin-top: 12px; margin-bottom: 4px; background: var(--panel-bg); }
    .header-toggle { display: flex; background: var(--panel-bg); border-radius: 6px; overflow: hidden; width: 180px; height: 28px; }
    .header-toggle button { flex: 1; padding: 4px 6px; border: none; background: transparent; color: var(--text-secondary); font-size: 11px; cursor: pointer; }
    .header-toggle .active { background: var(--secondary-bg); color: var(--text-primary); font-weight: 500; }

    /* shift nav & toggles 0.1cm right */
    nav.main-nav, .sub-toggle, .section-toggle { transform: translateX(0.1cm); }

    nav.main-nav { display: flex; margin: 0 12px; background: var(--panel-bg); padding: 4px 0; }
    nav.main-nav a { margin-right: 16px; text-decoration: none; color: var(--text-secondary); font-size: 13px; padding: 8px 0; white-space: nowrap; }
    nav.main-nav a.active { color: var(--text-primary); font-weight: 500; }

    .sub-toggle { display: flex; margin: 8px 12px; background: var(--panel-bg); padding: 4px; border-radius: 4px; }
    .sub-toggle button { margin-right: 8px; padding: 5px 10px; background: var(--panel-bg); border: none; border-radius: 4px; color: var(--text-secondary); font-size: 12px; cursor: pointer; }
    .sub-toggle .active { background: var(--secondary-bg); color: var(--text-primary); }

    .section-toggle { display: flex; margin: 12px; background: var(--panel-bg); padding: 4px; border-radius: 4px; }
    .section-toggle div { margin-right: 16px; cursor: pointer; font-size: 13px; position: relative; color: var(--text-secondary); }
    .section-toggle .active { color: var(--text-primary); font-weight: 500; }
    .section-toggle .active::after { content: ''; position: absolute; bottom: -4px; left: 50%; transform: translateX(-50%); width: 20px; height: 2px; background: var(--highlight); }

    .feed { display: flex; flex-direction: column; gap: 8px; flex: 1; overflow-y: auto; padding: 0 12px; margin-bottom: 4px; background: var(--panel-bg); }
    .feed::-webkit-scrollbar { display: none; }

    .trade-panel { background: var(--panel-bg); padding: 12px; border-radius: 8px; transition: transform 0.5s ease; }
    .trade-panel .header { display: flex; align-items: center; margin-bottom: 8px; }
    .icon-buy { background: var(--text-green); color: #fff; width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: bold; margin-right: 8px; }
    .symbol { font-size: 14px; font-weight: 500; margin-right: 6px; color: var(--text-primary); }
    .tag { background: var(--secondary-bg); color: var(--text-secondary); font-size: 10px; padding: 1px 4px; margin-right: 4px; text-transform: uppercase; }
    .exclamations { display: flex; margin-left: 6px; }
    .exclamations span { position: relative; width: 2px; height: 10px; background: var(--secondary-bg); margin: 0 1px; border-radius: 1px; transition: background 0.3s ease; }
    .exclamations span::after { content: ''; position: absolute; bottom: -3px; left: 50%; transform: translateX(-50%); width: 2px; height: 2px; background: inherit; border-radius: 50%; }
    .exclamations span.green, .exclamations span.green::after { background: var(--text-green); }
    .share { margin-left: auto; color: var(--text-secondary); font-size: 16px; cursor: pointer; }

    .content-columns { display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 8px; }
    .column { display: flex; flex-direction: column; }
    .column.right { text-align: right; }
    .stat { margin-bottom: 8px; }
    .label { font-size: 12px; color: var(--text-secondary); border-bottom: 1px dotted var(--text-secondary); padding-bottom: 2px; display: inline-block; }
    .label.no-line { border-bottom: none; }
    .value { font-size: 14px; font-weight: 400; color: var(--text-primary); transition: all 0.3s ease; }
    .value.green, .value.percent.green { color: var(--text-green); font-size: 18px; font-weight: bold; }
    .value.red, .value.percent.red { color: var(--text-red); font-size: 18px; font-weight: bold; }
    .margin-ratio-value { font-size: 12px !important; }

    .actions { display: flex; justify-content: space-between; }
    .btn { flex: 1; background: var(--btn-bg); color: #fff; border: none; border-radius: 4px; padding: 6px 0; font-size: 12px; cursor: pointer; margin: 0 4px; transition: background 0.3s; }
    .btn:hover { background: var(--secondary-bg); }
  </style>
</head>
<body>
  <!-- Centered Toggle -->
  <div class="header-wrapper">
    <div class="header-toggle">
      <button class="active">Exchange</button>
      <button>Wallet</button>
    </div>
  </div>

  <!-- Main Navigation -->
  <nav class="main-nav">
    <a href="#" class="active">Overview</a>
    <a href="#">Funding</a>
    <a href="#futures">Futures</a>
    <a href="#">Spot</a>
  </nav>

  <!-- Sub Toggle -->
  <div class="sub-toggle">
    <button class="active">USDⓈ-M</button>
    <button>COIN-M</button>
  </div>

  <!-- Section Toggle -->
  <div class="section-toggle">
    <div class="active">Positions</div>
    <div>Assets</div>
  </div>

  <!-- Profit Feed Container -->
  <div class="feed"></div>

  <script>
    // per-symbol decimal precision map
    const symbolPrecisions = {
      BTCUSDT: 2, ETHUSDT: 2, BNBUSDT: 2, ADAUSDT: 3,
      SOLUSDT: 3, XRPUSDT: 4, DOTUSDT: 3, LTCUSDT: 2,
      LINKUSDT: 3, DOGEUSDT: 4,
      AAVEUSDT: 3, SUSHIUSDT: 3, SHIBUSDT: 6, COMPUSDT: 3, ETCUSDT: 3, ZECUSDT: 2, XMRUSDT: 2, LRCUSDT: 4, QNTUSDT: 3, CRVUSDT: 4,
      UNIUSDT: 3, BCHUSDT: 2, XLMUSDT: 4, ATOMUSDT: 3, MATICUSDT: 4, AVAXUSDT: 3,
      TRXUSDT: 4, EOSUSDT: 3, NEARUSDT: 3, FILUSDT: 3
    };
    function getPrecision(sym) { return symbolPrecisions[sym] ?? 2; }
    function formatNumber(sym, x) {
      const p = getPrecision(sym);
      const s = x.toFixed(p);
      const [intPart, decPart] = s.split('.');
      const intFmt = intPart.replace(/\B(?=(\d{3})+(?!\d))/g, ",");
      return decPart !== undefined ? `${intFmt}.${decPart}` : intFmt;
    }

    const maintenanceMarginRates = {
      BTCUSDT: 0.004, ETHUSDT: 0.005, BNBUSDT: 0.005, ADAUSDT: 0.01,
      SOLUSDT: 0.008, XRPUSDT: 0.01, DOTUSDT: 0.01, LTCUSDT: 0.01,
      LINKUSDT: 0.01, DOGEUSDT: 0.012,
      AAVEUSDT: 0.01, SUSHIUSDT: 0.015, SHIBUSDT: 0.02, COMPUSDT: 0.01, ETCUSDT: 0.01, ZECUSDT: 0.015, XMRUSDT: 0.02, LRCUSDT: 0.02, QNTUSDT: 0.015, CRVUSDT: 0.02,
      UNIUSDT: 0.01, BCHUSDT: 0.01, XLMUSDT: 0.015, ATOMUSDT: 0.01, MATICUSDT: 0.01, AVAXUSDT: 0.01,
      TRXUSDT: 0.02, EOSUSDT: 0.015, NEARUSDT: 0.02, FILUSDT: 0.015
    };
    function getMaintRate(sym) { return maintenanceMarginRates[sym] || 0.005; }

    // settings
    const symbols         = Object.keys(symbolPrecisions);
    const allowedLeverages = [10, 15, 20, 50];
    const minPercent      = 100;
    const maxPercent      = 1800;
    const maxLossPercent  = 200;
    const minMargin       = 10;    // USDT
    const maxMargin       = 100;   // USDT
    const updateInterval  = 2000;  // ms between updates
    const maxDeltaPct     = 1;     // ±1% jitter per update
    const driftPerUpdate  = 0.0001;

    // exactly 20 trades, 0 random non-adjacent losers (all profits)
    const totalCount = 20;
    function pickLosers(count, total) {
      const losers = [];
      while (losers.length < count) {
        const idx = Math.floor(Math.random() * total);
        if (losers.includes(idx)) continue;
        if (losers.some(x => Math.abs(x - idx) === 1)) continue;
        losers.push(idx);
      }
      return losers;
    }
    const loseIdxs = pickLosers(0, totalCount);

    function formatTwoDP(x) {
      const s = x.toFixed(2);
      const [intPart, decPart] = s.split('.');
      return intPart.replace(/\B(?=(\d{3})+(?!\d))/g, ",") + "." + decPart;
    }

    async function initTrades() {
      try {
        const res  = await fetch('https://api.binance.com/api/v3/ticker/price');
        const data = await res.json();
        const priceMap = Object.fromEntries(data.map(d => [d.symbol, parseFloat(d.price)]));

        const feedDiv  = document.querySelector('.feed');
        const trades   = [];

        for (let i = 0; i < totalCount; i++) {
          const sym    = symbols[i % symbols.length];
          const price  = priceMap[sym] || 0;
          const isLoss = loseIdxs.includes(i);

          const entryPrice  = price * 0.94;
          const initialMark = price * 0.98;
          const leverage    = allowedLeverages[Math.floor(Math.random() * allowedLeverages.length)];
          const margin      = Math.random() * (maxMargin - minMargin) + minMargin;

          let rawPct = Math.random() * (maxPercent - minPercent) + minPercent;
          rawPct = isLoss ? -rawPct : rawPct;

          let pnl = margin * Math.abs(rawPct) / 100 * (isLoss ? -1 : 1);
          const minPnL = margin * minPercent / 100;
          const maxPnL = margin * maxPercent / 100;
          pnl = isLoss
            ? -Math.min(maxPnL, Math.max(minPnL, -pnl))
            :  Math.min(maxPnL, Math.max(minPnL,  pnl));

          const liqPrice    = entryPrice * (1 - 1 / leverage);
          const notional    = margin * leverage;
          const maintenance = notional * getMaintRate(sym);
          const equity      = margin + pnl;
          const mRatio      = maintenance / equity * 100;

          const panel = document.createElement('div');
          panel.className = 'trade-panel';
          panel.innerHTML =
            `<div class="header">
               <span class="icon-buy">B</span>
               <span class="symbol">${sym}</span>
               <span class="tag">PERP</span>
               <span class="tag">Cross ${leverage}×</span>
               <span class="exclamations">${
                 (() => {
                   let html = '';
                   const totalBars = 4;
                   const greenBars = Math.floor(Math.random() * totalBars) + 1;
                   for (let j = 0; j < totalBars; j++) {
                     html += `<span class="${j < greenBars ? 'green' : ''}"></span>`;
                   }
                   return html;
                 })()
               }</span>
               <i class="fas fa-share-alt share"></i>
             </div>
             <div class="content-columns">
               <div class="column">
                 <div class="stat">
                   <div class="label">PNL (USDT)</div>
                   <div class="value ${pnl < 0 ? 'red' : 'green'}">${formatTwoDP(pnl)}</div>
                 </div>
                 <div class="stat">
                   <div class="label">Size (USDT)</div>
                   <div class="value">${formatNumber(sym, notional)}</div>
                 </div>
                 <div class="stat">
                   <div class="label">Entry Price (USDT)</div>
                   <div class="value">${formatNumber(sym, entryPrice)}</div>
                 </div>
               </div>
               <div class="column center">
                 <div class="stat">
                   <div class="label no-line">Margin (USDT)</div>
                   <div class="value">${formatTwoDP(margin)}</div>
                 </div>
                 <div class="stat">
                   <div class="label no-line">Mark Price (USDT)</div>
                   <div class="value">${formatNumber(sym, initialMark)}</div>
                 </div>
               </div>
               <div class="column right">
                 <div class="stat">
                   <div class="label">ROI</div>
                   <div class="value percent ${pnl < 0 ? 'red' : 'green'}">${(pnl >= 0 ? '+' : '') + (Math.abs(rawPct)).toFixed(2)}%</div>
                 </div>
                 <div class="stat margin-ratio">
                   <div class="label">Margin Ratio</div>
                   <div class="value percent margin-ratio-value ${mRatio >= 80 ? 'red' : 'green'}">${mRatio.toFixed(2)}%</div>
                 </div>
                 <div class="stat">
                   <div class="label no-line">Liq. Price (USDT)</div>
                   <div class="value">${formatNumber(sym, liqPrice)}</div>
                 </div>
               </div>
             </div>
             <div class="actions">
               <button class="btn">Leverage</button>
               <button class="btn">TP/SL</button>
               <button class="btn">Close</button>
               <button class="btn">Reverse</button>
             </div>`;
          feedDiv.appendChild(panel);
          trades.push({ panel, sym, margin, entryPrice, leverage, currentMark: initialMark });
        }

        // update loop
        setInterval(() => {
          trades.forEach((t, i) => {
            const pnlEl = t.panel.querySelector('.value:not(.percent)');
            const roiEl = t.panel.querySelector('.value.percent');
            const sign  = parseFloat(roiEl.textContent) >= 0 ? 1 : -1;
            let pct      = Math.abs(parseFloat(roiEl.textContent));
            pct         += (Math.random() * 2 - 1) * maxDeltaPct;
            pct         = Math.max(minPercent, Math.min(maxPercent, pct));
            let pnl      = t.margin * pct / 100 * sign;
            const minP   = t.margin * minPercent / 100;
            const maxP   = t.margin * maxPercent / 100;
            pnl         = sign > 0
              ? Math.min(maxP, Math.max(minP, pnl))
              : -Math.min(maxP, Math.max(minP, -pnl));

            t.currentMark *= 1 + driftPerUpdate;
            const markP   = t.currentMark;
            const liqP    = t.entryPrice * (1 - 1 / t.leverage);
            const notional= t.margin * t.leverage;
            const mRatio  = (notional * getMaintRate(t.sym)) / (t.margin + pnl) * 100;

            // update PNL
            pnlEl.textContent = formatTwoDP(pnl);
            pnlEl.classList.toggle('green', pnl >= 0);
            pnlEl.classList.toggle('red', pnl < 0);

            // update Mark Price
            t.panel.querySelectorAll('.value')[4].textContent = formatNumber(t.sym, markP);

            // update ROI
            roiEl.textContent = (pnl >= 0 ? '+' : '') + pct.toFixed(2) + '%';
            roiEl.classList.toggle('green', pnl >= 0);
            roiEl.classList.toggle('red', pnl < 0);

            // update Margin Ratio
            t.panel.querySelectorAll('.value.margin-ratio-value')[0].textContent = mRatio.toFixed(2) + '%';

            // update Liq. Price
            t.panel.querySelectorAll('.value')[7].textContent = formatNumber(t.sym, liqP);
          });
        }, updateInterval);

      } catch (err) {
        console.error('Failed to fetch Binance prices:', err);
      }
    }

    initTrades();
  </script>
</body>
</html>
<!-- partial -->
  
</body>
</html>
